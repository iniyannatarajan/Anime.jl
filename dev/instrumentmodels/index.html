<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Instrument Models · Anime.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://iniyannatarajan.github.io/Anime.jl/instrumentmodels/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Anime.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Anime.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../components/">Components</a></li><li class="is-active"><a class="tocitem" href>Instrument Models</a><ul class="internal"><li><a class="tocitem" href="#Radio-Interferometer-Measurement-Equation"><span>Radio Interferometer Measurement Equation</span></a></li><li><a class="tocitem" href="#Gaussian-Process-Modelling"><span>Gaussian Process Modelling</span></a></li><li><a class="tocitem" href="#The-Earth&#39;s-Atmosphere"><span>The Earth&#39;s Atmosphere</span></a></li><li><a class="tocitem" href="#Instrumental-Polarization"><span>Instrumental Polarization</span></a></li><li><a class="tocitem" href="#Primary-Beams"><span>Primary Beams</span></a></li><li><a class="tocitem" href="#Bandpass-and-Receiver-Gains"><span>Bandpass and Receiver Gains</span></a></li><li><a class="tocitem" href="#Noise-Components"><span>Noise Components</span></a></li></ul></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../examples/createdataset/">Creating data sets</a></li><li><a class="tocitem" href="../examples/computecoherency/">Compute coherency matrix</a></li><li><a class="tocitem" href="../examples/loadobservation/">Read/write MS</a></li><li><a class="tocitem" href="../examples/computemodels/">Compute instrument models</a></li><li><a class="tocitem" href="../examples/pipeline/">Running in pipeline mode</a></li></ul></li><li><a class="tocitem" href="../api/">Anime API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Instrument Models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Instrument Models</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/iniyannatarajan/Anime.jl/blob/main/docs/src/instrumentmodels.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Instrument-Models"><a class="docs-heading-anchor" href="#Instrument-Models">Instrument Models</a><a id="Instrument-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Instrument-Models" title="Permalink"></a></h1><p>VLBI enables the highest angular resolution achievable in astronomy, up to ~20 μas in the case of the Event Horizon Telescope (EHT) that produced the first ever images of a black hole in 2019. Since VLBI uses a sparse, heterogeneous array of radio telescopes situated around the planet, reconstructing images of observed astronomical sources is an ill-posed problem, and a deeper understanding of not only the astronomical source of interest but the instrument itself becomes crucial. Detailed explanation of the theory behind the aspects of the instrument that are modelled can be found in standard textbooks<sup class="footnote-reference"><a id="citeref-TMS" href="#footnote-TMS">[TMS]</a></sup> and other references scattered throughout this documentation.</p><h2 id="Radio-Interferometer-Measurement-Equation"><a class="docs-heading-anchor" href="#Radio-Interferometer-Measurement-Equation">Radio Interferometer Measurement Equation</a><a id="Radio-Interferometer-Measurement-Equation-1"></a><a class="docs-heading-anchor-permalink" href="#Radio-Interferometer-Measurement-Equation" title="Permalink"></a></h2><p>The Radio Interferometer Measurement Equation (RIME)<sup class="footnote-reference"><a id="citeref-HBS" href="#footnote-HBS">[HBS]</a></sup><sup class="footnote-reference"><a id="citeref-OMS" href="#footnote-OMS">[OMS]</a></sup> lies at the heart of modelling interferometric observations. A generic discrete RIME can be written as</p><p class="math-container">\[\mathbf{V}_{pq} = G_p \left( \sum_{s} E_{sp}\, \mathbf{X}_{spq}\, E_{sq}^H \right) G_q^H,\]</p><p>where the summation is carried out over all the sources <span>$s$</span>, and <span>$\boldsymbol{E}_{sp}$</span> and <span>$\boldsymbol{G}_p$</span> denote generic direction-dependent effects (DDEs) and direction-independent effects (DIEs) respectively. Each term is a <span>$2\times2$</span> <em>Jones</em> matrix that describes any linear transformation acting on the incoming wave, and <span>$H$</span> is the Hermitian conjugate.</p><p>Forward modelling the instrument consists of generating the Jones matrices in a physically meaningful way. <code>Anime</code> can currently model effects such as tropospheric absorption and emission and phase delays, instrumental polarization, primary beam attenuation due to mispointing, and complex bandpass and receiver gains. The additive noise terms due to the troposphere and thermal noise are also modelled.</p><h2 id="Gaussian-Process-Modelling"><a class="docs-heading-anchor" href="#Gaussian-Process-Modelling">Gaussian Process Modelling</a><a id="Gaussian-Process-Modelling-1"></a><a class="docs-heading-anchor-permalink" href="#Gaussian-Process-Modelling" title="Permalink"></a></h2><p><code>Anime</code> uses Gaussian processes (GPs) to model time series. Gaussian processes are a generalization of the Gaussian probability distribution for functions (not just random variables). They define a probability distribution over possible functions that fit the data. A prior over the function space is encoded by the <em>kernel</em> function which takes two input data points and returns a measure of the covariance between them. Some kernel functions are manually implemented within <code>Anime</code>, with the <em>squared exponential (SE)</em> kernel (aka the <em>Gaussian</em> or the <em>radial basis function (RBF)</em> kernel) used as the default:</p><p>The SE kernel is defined as</p><p class="math-container">\[k_{SE}(x-x&#39;) = \sigma^2 e^{-\frac{(x-x&#39;)^2}{2\rho^2}}\]</p><p>The variance <span>$\sigma^2$</span> is the scale factor and <span>$\rho$</span> is the characteristic length scale that determines the smoothness of the function. More information on GPs can be found in standard references<sup class="footnote-reference"><a id="citeref-GPML" href="#footnote-GPML">[GPML]</a></sup>.</p><h2 id="The-Earth&#39;s-Atmosphere"><a class="docs-heading-anchor" href="#The-Earth&#39;s-Atmosphere">The Earth&#39;s Atmosphere</a><a id="The-Earth&#39;s-Atmosphere-1"></a><a class="docs-heading-anchor-permalink" href="#The-Earth&#39;s-Atmosphere" title="Permalink"></a></h2><p>Starting from a few GHz and above, the lowest layer of Earth&#39;s atmosphere, the troposphere, comes into play and is a significant contributor to signal corruptions at mm and sub-mm wavelengths. In <code>Anime</code> we characterize it as consisting of a &quot;mean&quot; component and an additional rapidly varying turbulent component, following the python implementation in <code>MEQSv2</code><sup class="footnote-reference"><a id="citeref-IN2022" href="#footnote-IN2022">[IN2022]</a></sup>.</p><p>The mean troposphere introduces smoothly varying time delays that result in phase slopes with frequency. The turbulence in the troposphere introduces rapidly-varying &quot;ad hoc&quot; delays. The troposphere also absorbs radiation due to molecular transitions (rotational transitions of H<span>$_2$</span>O and O<span>$_2$</span>). This, along with a frequency-dependent component to the opacity of the troposphere results in an attenuation of visibility amplitudes. In thermodynamic equilibrium, the troposphere also emits radiation which increases the system temperature.</p><p>The path length due to the wet (H<span>$_2$</span>O) and non-wet troposphere is computed using <a href="https://www.mrao.cam.ac.uk/~bn204/alma/atmomodel.html#aatm-download"><code>AATM</code></a><sup class="footnote-reference"><a id="citeref-JRP2001" href="#footnote-JRP2001">[JRP2001]</a></sup> and is used to generate the delays due to mean troposphere. Delays due to turbulence are simulated using Brownian random walk. The elevation and transmission-dependent sky noise due to increased system temperature is accounted for in the noise budget.</p><h2 id="Instrumental-Polarization"><a class="docs-heading-anchor" href="#Instrumental-Polarization">Instrumental Polarization</a><a id="Instrumental-Polarization-1"></a><a class="docs-heading-anchor-permalink" href="#Instrumental-Polarization" title="Permalink"></a></h2><p>While the two polarization feeds on an antenna nominally measure orthogonal polarization states of the electromagnetic wave, mechanical/electronic imperfections in the signal path both feeds to be receptive to a small fraction of the other polarization state. In addition, the mount type of any azimuthally mounted telescope causes the feeds to rotate with respect to the sky which needs to be corrected for. These corrections together constitute the instrumental contribution to the polarization state of the recorded signal.</p><p>These effects are captured using the P-Jones (parallactic angle rotation) and D-Jones (polarization leakage) matrices given by<sup class="footnote-reference"><a id="citeref-Hales2017" href="#footnote-Hales2017">[Hales2017]</a></sup></p><p class="math-container">\[P_p = \begin{pmatrix} \mathrm{e}^{-j\chi_{_p}} &amp;&amp; 0 \\ 0 &amp;&amp; \mathrm{e}^{j\chi_{_p}} \end{pmatrix}\]</p><p>and</p><p class="math-container">\[D_p = \begin{pmatrix} 1 &amp;&amp; d_{pR} \\ -d_{pL} &amp;&amp; 1 \end{pmatrix}\, .\]</p><p>The observed visibilities are given by</p><p class="math-container">\[\mathbf{V} = (P_p^H) D_p (P_p) \mathbf{V}_{\rm sky} (P_q^H) D_q^H (P_q)\]</p><p>where</p><p class="math-container">\[P_p^H D_p P_p = \begin{pmatrix} 1 &amp; \exp(2j\chi_p)d_p^R \\ \exp(-2j\chi_p)d_p^L &amp; 1\end{pmatrix}\, .\]</p><h2 id="Primary-Beams"><a class="docs-heading-anchor" href="#Primary-Beams">Primary Beams</a><a id="Primary-Beams-1"></a><a class="docs-heading-anchor-permalink" href="#Primary-Beams" title="Permalink"></a></h2><p>The primary beams of participating stations determine the Field-of-View (FoV) of the observation. Several factors cause antennas to mispoint and modify its gain response, attenuating the measured visibility amplitudes, <span>$|\mathbf{V}_{pq}|$</span>. At mm-wavelengths even small errors in antenna pointing can cause significant attenuation.</p><p>The rms pointing error per station <span>$\mathcal{P}_{\rm rms}$</span> values supplied by the user depend on site characteristics determined based on empirical measurements. The set of correlated per scan pointing offsets (<span>${\rho_p}$</span>) per pointing interval is obtained using GP, with <span>$\mathcal{P}_{\rm rms}$</span> as the scale parameter and the scan length as the characteristic length. A Gaussian primary beam profile is then used to model the primary beamshapes of the antennas, which is an acceptable approximation at the few hundreds of <span>$\mu$</span>as FoV that we are interested in for mm-VLBI.</p><p class="math-container">\[E_p = \mathrm{e}^{\Bigg( -\frac{1}{2} \Bigg[\frac{\rho_p}{(\mathcal{P}_{{\rm FWHM}, p}/2\sqrt{2\ln 2})}\Bigg]^2 \Bigg)}\]</p><p>where</p><p class="math-container">\[\rho_p = \sqrt{\delta l_p^2 + \delta m_p^2}\]</p><h2 id="Bandpass-and-Receiver-Gains"><a class="docs-heading-anchor" href="#Bandpass-and-Receiver-Gains">Bandpass and Receiver Gains</a><a id="Bandpass-and-Receiver-Gains-1"></a><a class="docs-heading-anchor-permalink" href="#Bandpass-and-Receiver-Gains" title="Permalink"></a></h2><p>The generic receiver gain matrix can have both a time-varying and a frequency-varying component. The frequency-dependent component (the <em>B-Jones</em> matrix), aims to capture the variations in the amplitude and phase of the measured correlation coefficients across the bandwidth. Representative complex bandpass gains are used to spline interpolate over the entire frequency range independently for the two polarization feeds to construct the B-Jones terms.</p><p>The time-dependent gain matrix (often just referred to as <em>G-Jones</em> matrix) per station is generated using GP, with representative station-based scale parameters and the characteristic length set to the scan length to ensure smooth variation of gains over the duration of a scan. The amplitudes and phases of these terms are generated with different smoothness scales to capture the statistical properties of receiver gain evolution over time in real observations.</p><p>Both terms are modelled using diagonal 2 x 2 Jones terms, assuming that the polarization basis of the gain matrices is the same as that of the visibilities. Currently, the basis in which complex visibilities are represented is the default and only option in which to represent the basis of the gain matrices.</p><p class="math-container">\[G_p(t) = \begin{pmatrix} g_{pR}(t) &amp;&amp; 0 \\ 0 &amp;&amp; g_{pL}(t) \end{pmatrix}; B_p(\nu) = \begin{pmatrix} b_{pR}(\nu) &amp;&amp; 0 \\ 0 &amp;&amp; b_{pL}(\nu) \end{pmatrix}\]</p><h2 id="Noise-Components"><a class="docs-heading-anchor" href="#Noise-Components">Noise Components</a><a id="Noise-Components-1"></a><a class="docs-heading-anchor-permalink" href="#Noise-Components" title="Permalink"></a></h2><p>Apart from the sky noise contribution mentioned earlier, a receiver thermal noise model is also included in the noise budget. Station-based SEFD values are used to determine the per-visibility rms noise, <span>$\sigma_{th_{pq}}$</span>:</p><p class="math-container">\[\sigma_{th_{pq}} = \frac{1}{\eta} \sqrt{\frac{{\mathrm{SEFD}}_p {\mathrm{SEFD}}_q}{2\Delta \nu \tau}}\]</p><p>where <span>$A_{\mathrm e}$</span> denotes the effective area of the telescope and <span>$\eta$</span> comprises any relevant efficiency terms, such as the antenna aperture efficiency, <span>$\eta_{\rm ap}$</span>, and the correlator efficiency, <span>$\eta_{\rm corr}$</span>, <span>$\Delta\nu$</span> is the bandwidth and <span>$\tau$</span> the integration time. For standard 2-bit quantization, <span>$\eta$</span> is set to 0.88. The SEFD itself is defined as</p><p class="math-container">\[\mathrm{SEFD} = \frac{2 k_{\mathrm B} T_{\mathrm{sys}}}{\eta_{\mathrm{ant}} A_{\mathrm e}}\]</p><p>where <span>$\eta_{mathrm{ant}}$</span> is the antenna efficiency and <span>$A_{\mathrm e}$</span> is the effective area of the antenna.</p><h3 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h3><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-TMS"><a class="tag is-link" href="#citeref-TMS">TMS</a>Thompson A.R., Moran J.M., Swenson Jr. G.W. Interferometry and Synthesis in Radio Astronomy (2017) <a href="https://link.springer.com/book/10.1007/978-3-319-44431-4">Springer</a></li><li class="footnote" id="footnote-HBS"><a class="tag is-link" href="#citeref-HBS">HBS</a>Hamaker J.P., Bregman J.D., Sault R.J. Understanding radio polarimetry I (1996) <a href="https://articles.adsabs.harvard.edu/pdf/1996A%26AS..117..137H">A&amp;AS</a></li><li class="footnote" id="footnote-OMS"><a class="tag is-link" href="#citeref-OMS">OMS</a>Smirnov O.M. Revisiting the radio interferometry measurement equation I (2011) <a href="https://www.aanda.org/articles/aa/pdf/2011/03/aa16082-10.pdf">A&amp;A</a></li><li class="footnote" id="footnote-GPML"><a class="tag is-link" href="#citeref-GPML">GPML</a>Rasmussen C.E., and Williams C. Gaussian Processes for Machine Learning <a href="https://gaussianprocess.org/gpml/">MIT</a></li><li class="footnote" id="footnote-IN2022"><a class="tag is-link" href="#citeref-IN2022">IN2022</a>Natarajan I. et al. MeqSilhouette v2: spectrally resolved polarimetric synthetic data generation for EHT (2022) <a href="https://academic.oup.com/mnras/article/512/1/490/6537429">MNRAS</a></li><li class="footnote" id="footnote-JRP2001"><a class="tag is-link" href="#citeref-JRP2001">JRP2001</a>Pardo J.R., et al. Atmospheric transmission at microwaves (ATM): an improved model for mm/submm applications (2001) <a href="https://ieeexplore.ieee.org/document/982447">IEEE Xplore</a></li><li class="footnote" id="footnote-Hales2017"><a class="tag is-link" href="#citeref-Hales2017">Hales2017</a>Hales C., Calibration Errors in Interferometric Radio Polarimetry (2017) <a href="https://iopscience.iop.org/article/10.3847/1538-3881/aa7aef">The Astronomical Journal</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../components/">« Components</a><a class="docs-footer-nextpage" href="../examples/createdataset/">Creating data sets »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 20 December 2023 19:57">Wednesday 20 December 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
